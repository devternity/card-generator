language: java
jdk:
- oraclejdk8
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
- pip
- directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
script: "./gradlew -iS build -x test"
env:
  global:
  - secure: ZtI5z9uZ9PKa/0zAzIabwQK6vXAwFjXNK3uyDmXBZGV33xpf78bqPs7G9mjWbZ2vldoMpT54+uph0kaFDo6sHEQ/7Cssb6trkdKZhvIO1kYjbzDNl/Og5p5QErQBsUye//VJYzBxdNIh9tWvGhQP3zVlF6aNc68Z44ix1V57EVImt4p79vZCjnWlZqdsYBG6c/aoVoY6XoqC4HZJeDaQqjCx4ycJ9UpMIte7RGuTL2bb6deaF6kVyhLd37JZkT2/AJyKwUx485KQ4C+EwWelgl/9yrb0H3nmvNHoGW05wtoov01ONwhECA+smNv9jnuKl4+E4bYuvXGrkdWIPKZ0UvTGYr+IJub2/AToNiVQzHJ63ul/zYAi2ULbi5QIvLHuNtI+cz3BaAlCATCl7Gxdl1ZhL5QYC3oJwzodfUam2J692qnFEdajbDQQGiciNxt5zsRzwQglo0uWeKVnzG9vsyEui36k1i0HoLFuEyNJQeqiNEPd0aZVX0gqe3qhlNlunQrUG3AEDs/pta/UyCMHIpX2JEwYjT5gZOTdDGivYmo6l2yseV9+PfOTLskbbpPPXzE9fFi4pUa7uyHW2/tJdj9jNZRDJL8lS6Afq8yuakxLk6x46N2Bry6fJE2BW+2sDHJTudlcj5A0DNJdc2/vvZ1rntmIvQwp+BXQKnndMcU=
before_deploy:
- pip install --user awscli
deploy:
- provider: s3
  skip_cleanup: true
  region: eu-west-1
  bucket: devternity-code
  local_dir: build/distributions
  acl: public_read
after_deploy:
- aws lambda update-function-code --function-name devternity_card_generator --s3-bucket
  devternity-code --s3-key card-generator.zip
notifications:
  slack:
    secure: ZSh5SQZqQxI2JpAMkK6Uv0TreIyqQyNQWki5m6IRS8hHDwOD1WvDBSIwQor2hjyW7DTp61luvs6T/ON/vRyTBRfmpH71rwgBmtBih2PvVs0Xm+8+A1vwqlHuB/4zs5tgh6fo81RUth8fJJjd5txwdo7YLNZv3qXEw7wpkFHVPWgEIcOSKtabipKgei81ryqEAi8QeHFNhDJx+sUQtrreePj4G32l5k1f2Ua0IM8viPD87obhXDU1xPCPNZk1XliqZ5hgMHnnBcRi8L8SEP/WEgt//xuIHQ3IWY8qJlBwAqRK05uPSF/k10gtfugfheL50TxblfKMiJO2bi0uX7Yo+ZxMJsU1NA/xPJokKtukCi8PH0rPvgDhvRKLOYf89bhp2pxIs/CikoLcwWZFMgm6NeWfH1IfMQFkwk2Bj+OlWbqqnBZO/7mHJ1LUd0iVVFzG+AqKCHFwP23Wa16xEQK9XxyeFwHAnLx2YdmCIFUSTwrYB+yru57WLZa6ZhGY0tGC6alEi6UFuJGin2D/Q1ajdMR86gMRbqXvBYdkShtHa/NdLEM1+bTGWyE553xfVHzovc3P3QeEAiRR4je4V3PwqJrn7JoTcSMor7kUZrNRT+Rv7A1K8RFALe3VRObdlz0jFThoXrZyyVlPIRf4Eg9UrKGKpy16ednWk5UvSun0NTo=
